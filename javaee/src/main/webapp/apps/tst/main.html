<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>tes666</title>
    <link rel="stylesheet" href="../../lib/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="http://www.b.easyxue.cn/INS/css/plugins/fullcalendar/fullcalendar.css">
    <script src="../../lib/jquery/jquery.min.js" type="text/javascript"></script>
    <script src="moment.js" type="text/javascript"></script>
    <script src="http://www.b.easyxue.cn/INS/js/plugins/fullcalendar/fullcalendar.min.js" type="text/javascript"></script>

    <script>
        $(document).ready(function() {
            var h = {};
            if ($('#calendar').width() <= 400) {
                $('#calendar').addClass("mobile");
                h = {
                    left: ' prev, next',
                    center: 'title',
                    right: 'today'
                };
            } else {
                h = {
                    left: ' prev, next',
                    center: 'title',
                    right: 'today'
                };
                $('#calendar').removeClass("mobile");
            }
            $('#calendar').fullCalendar('destroy'); // destroy the calendar
            $('#calendar').fullCalendar({ // re-initialize the calendar
                disableDragging: false,
                header: h,
                editable: false,
                today: ["今天"],
                monthNames: ["1月 ", "2月 ", "3月 ", "4月 ", "5月 ", "6月 ", "7月 ", "8月 ", "9月 ", "10月 ", "11月 ", "12月 "],
                monthNamesShort: ["1月 ", "2月 ", "3月 ", "4月 ", "5月 ", "6月 ", "7月 ", "8月 ", "9月 ", "10月 ", "11月 ", "12月 "],
                dayNames: ["日", "一", "二", "三", "四", "五", "六"],
                dayNamesShort: ["日", "一", "二", "三", "四", "五", "六"],
                buttonText: {
                    today: '回到本月',
                },
                viewRender: function (view) {//动态把数据查出，按照月份动态查询   例子：http://www.cnblogs.com/xiaobaiczc/archive/2013/01/19/2867242.html
//                        var year = moment(view.start).format("YYYY");
//                        var month = moment(view.start).format("MM");
//                        $("#calendar").fullCalendar('removeEvents');
//                         $.ajax({
//                             type: "post",
//                             url: urls.getCalendar,
//                             data: {"year": year, "month": month * 1 },
//                             async:true,
//                             dataType: 'json',
//                             success: function (json) {
//                             	 d=json;
//                                  $.each(d.calendarList, function (index, term) {//cecece 灰掉的样式
//                                      $("#calendar").fullCalendar('renderEvent', term, true);
//                                  });
//                             }
//                         });
//                         $.post(urls.getCalendar, {"year": year, "month": month * 1}, function (data) {
//                             eval("d=" + data);
//                             $.each(d.calendarList, function (index, term) {//cecece 灰掉的样式
//                                 $("#calendar").fullCalendar('renderEvent', term, true);
//                             });
//                         }); //把从后台取出的数据进行封装以后在页面上以fullCalendar的方式进行显示
                    //显示今天的事项
//                        var myDate = new Date();
//                        var startTime = moment(date).format("YYYY-MM-DD");
//                        var startDate = moment(date).format("YYYY年MM月DD日");
//                        var ddTime = moment(date).format("DD");
//                        var weekDay = " 星期" + "日一二三四五六".split("")[myDate.getDay()];
//                        getCalendarList(startTime, startDate, weekDay, ddTime);
                },
                dayClick: function (date, allDay, jsEvent, view) {//日期点击后弹出的jq ui的框，添加日程记录
                    var date1 = new Date(date);
                    var startTime = moment(date).format("YYYY-MM-DD");
                    var startDate = moment(date).format("YYYY年MM月DD日");
                    var ddTime = moment(date).format("DD");
                    var weekDay = " 星期" + "日一二三四五六".split("")[date1.getDay()];
                    getCalendarList(startTime, startDate, weekDay, ddTime);
                    var day_date = $(this).data("date");
//                        $(this).parents('.fc-day-grid.fc-unselectable').find('td').removeClass("text-white");
//                        $(this).parents('.fc-bg').siblings('.fc-content-skeleton').find("td[data-date='" + day_date + "']").addClass("text-white");
                },
                eventAfterRender: function (event, element, view) {//数据绑定上去后添加相应信息在页面上
                },
                eventMouseover: function (calEvent, jsEvent, view) {
                },
                eventClick: function (event) {
                },
                events: function (start, end, timezone, callback) {
                    var year = this.getDate().format('YYYY');
                    var month = this.getDate().format('MM');
                    $("#calendar").fullCalendar('removeEvents');
                    $.ajax({
                        type: "post",
                        url:"getCalendar",
                        data: {"year": year, "month": month * 1},
                        async: true,
                        dataType: 'json',
                        success: function (json) {
                            d = json;
                            callback(d.calendarList);
                        }
                    });
                }
            });

        });
    </script>
</head>
<body>
        <div id="calendar"></div>
</body>
</html>